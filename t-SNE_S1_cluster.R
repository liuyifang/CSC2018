set.seed(42)

.libPaths('/lustre1/lch3000_pkuhpc/liuyf/R/R-3.4.1/library')
library(viridis)
library(monocle)

load('/lustre1/lch3000_pkuhpc/liuyf/denglab/zhaoting/monocle/AGG_estimate_size_and_dispersion.Robj')

Batch_vec <- c('MEF', 'SI5D', 'SI12D', 'XEN', 'SII8D', 'SII12D', 'SIII3D', 'SIII6D', 'SIII8D', 'SIII10D', 'SIII15D', 'SIII21D')
Batch_cols <- viridis(12, option = 'viridis')
names(Batch_cols) <- Batch_vec
Batch_labels <- c('MEF', 'SI D5', 'SI D12', 'XEN', 'SII D8', 'SII D12', 'SIII D3', 'SIII D6', 'SIII D8', 'SIII D10', 'SIII D15', 'SIII D21')
orderingGenes <- c("ENSMUSG00000028773","ENSMUSG00000038676","ENSMUSG00000008540","ENSMUSG00000061232","ENSMUSG00000020029","ENSMUSG00000026421","ENSMUSG00000018567","ENSMUSG00000054727","ENSMUSG00000056728","ENSMUSG00000001552","ENSMUSG00000005610","ENSMUSG00000050148","ENSMUSG00000020469","ENSMUSG00000027070","ENSMUSG00000038155","ENSMUSG00000075610","ENSMUSG00000018339","ENSMUSG00000028234","ENSMUSG00000029718","ENSMUSG00000027536","ENSMUSG00000060591","ENSMUSG00000014846","ENSMUSG00000038059","ENSMUSG00000034595","ENSMUSG00000038676","ENSMUSG00000049047","ENSMUSG00000044477","ENSMUSG00000030762","ENSMUSG00000044337","ENSMUSG00000000628","ENSMUSG00000033149","ENSMUSG00000032796","ENSMUSG00000029304","ENSMUSG00000029561","ENSMUSG00000095821","ENSMUSG00000054753","ENSMUSG00000022094","ENSMUSG00000023764","ENSMUSG00000021268","ENSMUSG00000026796","ENSMUSG00000081534","ENSMUSG00000005672","ENSMUSG00000059336","ENSMUSG00000086909","ENSMUSG00000059070","ENSMUSG00000061082","ENSMUSG00000003534","ENSMUSG00000001270","ENSMUSG00000029993","ENSMUSG00000022090","ENSMUSG00000032216","ENSMUSG00000019851","ENSMUSG00000018042","ENSMUSG00000030779","ENSMUSG00000031503","ENSMUSG00000032294","ENSMUSG00000045817","ENSMUSG00000027536","ENSMUSG00000046056","ENSMUSG00000020186","ENSMUSG00000029552","ENSMUSG00000032346","ENSMUSG00000014959","ENSMUSG00000022940","ENSMUSG00000040856","ENSMUSG00000001020","ENSMUSG00000026970","ENSMUSG00000028165","ENSMUSG00000099370","ENSMUSG00000005667","ENSMUSG00000032060","ENSMUSG00000027808","ENSMUSG00000106968","ENSMUSG00000024774","ENSMUSG00000027500","ENSMUSG00000001827","ENSMUSG00000023904","ENSMUSG00000032741","ENSMUSG00000023990","ENSMUSG00000091337","ENSMUSG00000038312","ENSMUSG00000022965","ENSMUSG00000062908","ENSMUSG00000028465","ENSMUSG00000061731","ENSMUSG00000039103","ENSMUSG00000031765","ENSMUSG00000031502","ENSMUSG00000035199","ENSMUSG00000029455","ENSMUSG00000018102","ENSMUSG00000054272","ENSMUSG00000022665","ENSMUSG00000024805","ENSMUSG00000022799","ENSMUSG00000056537","ENSMUSG00000067367","ENSMUSG00000049327","ENSMUSG00000021994","ENSMUSG00000029455","ENSMUSG00000008763","ENSMUSG00000028591","ENSMUSG00000053030","ENSMUSG00000003541","ENSMUSG00000047844","ENSMUSG00000027004","ENSMUSG00000041688","ENSMUSG00000042834","ENSMUSG00000063060","ENSMUSG00000029810","ENSMUSG00000015053","ENSMUSG00000030491","ENSMUSG00000078190","ENSMUSG00000057113","ENSMUSG00000027186","ENSMUSG00000028936","ENSMUSG00000023571","ENSMUSG00000032531","ENSMUSG00000038418","ENSMUSG00000035342","ENSMUSG00000033880","ENSMUSG00000025491","ENSMUSG00000037894","ENSMUSG00000022304","ENSMUSG00000030811","ENSMUSG00000067038","ENSMUSG00000033256","ENSMUSG00000092035","ENSMUSG00000042684","ENSMUSG00000091243","ENSMUSG00000049327","ENSMUSG00000061353","ENSMUSG00000028109","ENSMUSG00000006356","ENSMUSG00000031134","ENSMUSG00000053030","ENSMUSG00000021133","ENSMUSG00000035342","ENSMUSG00000026864","ENSMUSG00000032518","ENSMUSG00000026234","ENSMUSG00000006200","ENSMUSG00000027712","ENSMUSG00000022528","ENSMUSG00000027848","ENSMUSG00000046818","ENSMUSG00000034707","ENSMUSG00000034974","ENSMUSG00000035186","ENSMUSG00000029229","ENSMUSG00000023904","ENSMUSG00000042842","ENSMUSG00000064357","ENSMUSG00000023571","ENSMUSG00000059336","ENSMUSG00000030491","ENSMUSG00000085795","ENSMUSG00000028696","ENSMUSG00000019467","ENSMUSG00000024772","ENSMUSG00000020099","ENSMUSG00000018906","ENSMUSG00000023764","ENSMUSG00000100786","ENSMUSG00000023348","ENSMUSG00000079184","ENSMUSG00000063457","ENSMUSG00000023087","ENSMUSG00000038235","ENSMUSG00000058550","ENSMUSG00000039209","ENSMUSG00000028249","ENSMUSG00000027239","ENSMUSG00000029304","ENSMUSG00000044147","ENSMUSG00000037049","ENSMUSG00000032548","ENSMUSG00000097312","ENSMUSG00000025959","ENSMUSG00000028382","ENSMUSG00000021186","ENSMUSG00000006304","ENSMUSG00000061086","ENSMUSG00000050138","ENSMUSG00000022432","ENSMUSG00000027358","ENSMUSG00000019188","ENSMUSG00000032387","ENSMUSG00000001175","ENSMUSG00000078126","ENSMUSG00000048482","ENSMUSG00000032244","ENSMUSG00000032495","ENSMUSG00000034484","ENSMUSG00000029053","ENSMUSG00000057137","ENSMUSG00000019564","ENSMUSG00000050708","ENSMUSG00000028179","ENSMUSG00000021953","ENSMUSG00000038502","ENSMUSG00000033016","ENSMUSG00000021453","ENSMUSG00000037072","ENSMUSG00000036412","ENSMUSG00000020679","ENSMUSG00000025151","ENSMUSG00000001729","ENSMUSG00000027523","ENSMUSG00000019943","ENSMUSG00000067274","ENSMUSG00000044279","ENSMUSG00000021932","ENSMUSG00000039197","ENSMUSG00000039607","ENSMUSG00000027208","ENSMUSG00000000753","ENSMUSG00000056612","ENSMUSG00000025937","ENSMUSG00000027221","ENSMUSG00000010830","ENSMUSG00000007872","ENSMUSG00000055148","ENSMUSG00000032366","ENSMUSG00000095717","ENSMUSG00000006488","ENSMUSG00000030272","ENSMUSG00000050966","ENSMUSG00000052085","ENSMUSG00000046223","ENSMUSG00000032607","ENSMUSG00000020469","ENSMUSG00000025902","ENSMUSG00000015714","ENSMUSG00000026185","ENSMUSG00000001891","ENSMUSG00000074604","ENSMUSG00000030800","ENSMUSG00000042215","ENSMUSG00000006777","ENSMUSG00000020111","ENSMUSG00000029304","ENSMUSG00000061887","ENSMUSG00000004849","ENSMUSG00000029616","ENSMUSG00000074424","ENSMUSG00000028640","ENSMUSG00000026193","ENSMUSG00000027221","ENSMUSG00000005125","ENSMUSG00000040699","ENSMUSG00000018965","ENSMUSG00000032515","ENSMUSG00000044628","ENSMUSG00000040026","ENSMUSG00000006369","ENSMUSG00000031827","ENSMUSG00000006369","ENSMUSG00000025151","ENSMUSG00000020108","ENSMUSG00000031651","ENSMUSG00000022500","ENSMUSG00000023827","ENSMUSG00000042367","ENSMUSG00000016256","ENSMUSG00000028023","ENSMUSG00000034101","ENSMUSG00000081534","ENSMUSG00000078954","ENSMUSG00000053113","ENSMUSG00000015943","ENSMUSG00000090523","ENSMUSG00000026450","ENSMUSG00000028080","ENSMUSG00000003970","ENSMUSG00000071655","ENSMUSG00000032418","ENSMUSG00000084174","ENSMUSG00000035778","ENSMUSG00000001870","ENSMUSG00000025856","ENSMUSG00000079476","ENSMUSG00000035342","ENSMUSG00000070618","ENSMUSG00000066551","ENSMUSG00000002900","ENSMUSG00000005705","ENSMUSG00000042821","ENSMUSG00000020080","ENSMUSG00000035203","ENSMUSG00000001131","ENSMUSG00000061393","ENSMUSG00000022900","ENSMUSG00000070436","ENSMUSG00000070034","ENSMUSG00000068220","ENSMUSG00000025810","ENSMUSG00000067038","ENSMUSG00000001555","ENSMUSG00000021592","ENSMUSG00000038580","ENSMUSG00000047751","ENSMUSG00000058600","ENSMUSG00000001510","ENSMUSG00000041488","ENSMUSG00000053964","ENSMUSG00000021039","ENSMUSG00000092349","ENSMUSG00000056737","ENSMUSG00000061048","ENSMUSG00000061143","ENSMUSG00000000594","ENSMUSG00000079030","ENSMUSG00000087283","ENSMUSG00000026043","ENSMUSG00000050565","ENSMUSG00000037440","ENSMUSG00000022037","ENSMUSG00000040726","ENSMUSG00000067786","ENSMUSG00000061186","ENSMUSG00000020027","ENSMUSG00000007038","ENSMUSG00000018474","ENSMUSG00000021765","ENSMUSG00000025202","ENSMUSG00000022565","ENSMUSG00000022965","ENSMUSG00000036202","ENSMUSG00000030208","ENSMUSG00000020372","ENSMUSG00000038648","ENSMUSG00000023904","ENSMUSG00000032382","ENSMUSG00000027712","ENSMUSG00000025902","ENSMUSG00000027702","ENSMUSG00000015053","ENSMUSG00000079184","ENSMUSG00000031410","ENSMUSG00000028412","ENSMUSG00000017466","ENSMUSG00000030536","ENSMUSG00000066721","ENSMUSG00000001270","ENSMUSG00000051397","ENSMUSG00000020108","ENSMUSG00000024044","ENSMUSG00000066383","ENSMUSG00000049086","ENSMUSG00000015143","ENSMUSG00000046718","ENSMUSG00000008348","ENSMUSG00000032436","ENSMUSG00000022335","ENSMUSG00000030339","ENSMUSG00000063060","ENSMUSG00000016256","ENSMUSG00000031984","ENSMUSG00000029661","ENSMUSG00000046733","ENSMUSG00000022237","ENSMUSG00000022899","ENSMUSG00000097173","ENSMUSG00000042834","ENSMUSG00000037736","ENSMUSG00000084919","ENSMUSG00000029135","ENSMUSG00000027547","ENSMUSG00000025056","ENSMUSG00000032387","ENSMUSG00000037049","ENSMUSG00000027612","ENSMUSG00000013698","ENSMUSG00000020080","ENSMUSG00000021250","ENSMUSG00000033022","ENSMUSG00000024837","ENSMUSG00000037815","ENSMUSG00000061877","ENSMUSG00000046818","ENSMUSG00000028645","ENSMUSG00000029111","ENSMUSG00000043998","ENSMUSG00000027712","ENSMUSG00000053559","ENSMUSG00000039960","ENSMUSG00000028527","ENSMUSG00000074424","ENSMUSG00000037989","ENSMUSG00000053646","ENSMUSG00000022146","ENSMUSG00000026831","ENSMUSG00000032418","ENSMUSG00000030793","ENSMUSG00000064016","ENSMUSG00000034127","ENSMUSG00000047866","ENSMUSG00000013089","ENSMUSG00000050240","ENSMUSG00000026305","ENSMUSG00000056436","ENSMUSG00000057726","ENSMUSG00000037405","ENSMUSG00000021359","ENSMUSG00000001313","ENSMUSG00000030551","ENSMUSG00000057836","ENSMUSG00000037710","ENSMUSG00000007891","ENSMUSG00000017639","ENSMUSG00000026223","ENSMUSG00000067702","ENSMUSG00000024937","ENSMUSG00000021765","ENSMUSG00000025854","ENSMUSG00000027612","ENSMUSG00000026864","ENSMUSG00000049047","ENSMUSG00000068335","ENSMUSG00000039646","ENSMUSG00000019539","ENSMUSG00000021453","ENSMUSG00000026879","ENSMUSG00000027186","ENSMUSG00000026380","ENSMUSG00000001131","ENSMUSG00000026600","ENSMUSG00000039236","ENSMUSG00000056728","ENSMUSG00000041959","ENSMUSG00000047139","ENSMUSG00000046133","ENSMUSG00000010067","ENSMUSG00000063524","ENSMUSG00000032607","ENSMUSG00000006390","ENSMUSG00000072905","ENSMUSG00000028699","ENSMUSG00000029430","ENSMUSG00000041571","ENSMUSG00000061082","ENSMUSG00000078954","ENSMUSG00000018845","ENSMUSG00000020644","ENSMUSG00000072905","ENSMUSG00000070619","ENSMUSG00000015943","ENSMUSG00000021592","ENSMUSG00000006369","ENSMUSG00000031950","ENSMUSG00000000001","ENSMUSG00000026107","ENSMUSG00000026380","ENSMUSG00000023905","ENSMUSG00000070708","ENSMUSG00000042842","ENSMUSG00000046133","ENSMUSG00000039607","ENSMUSG00000023039","ENSMUSG00000032327","ENSMUSG00000031575","ENSMUSG00000033016","ENSMUSG00000002233","ENSMUSG00000029810","ENSMUSG00000008540","ENSMUSG00000011096","ENSMUSG00000001056","ENSMUSG00000007805","ENSMUSG00000005087","ENSMUSG00000048332","ENSMUSG00000020407","ENSMUSG00000040016","ENSMUSG00000020427","ENSMUSG00000079030","ENSMUSG00000022797","ENSMUSG00000037440","ENSMUSG00000033420","ENSMUSG00000022265","ENSMUSG00000040616","ENSMUSG00000061082","ENSMUSG00000049521","ENSMUSG00000022899","ENSMUSG00000039323","ENSMUSG00000036111","ENSMUSG00000108980","ENSMUSG00000074227","ENSMUSG00000005087","ENSMUSG00000032026","ENSMUSG00000035946","ENSMUSG00000031765","ENSMUSG00000028680","ENSMUSG00000053819","ENSMUSG00000027230","ENSMUSG00000064145","ENSMUSG00000036885","ENSMUSG00000027230","ENSMUSG00000029455","ENSMUSG00000028382","ENSMUSG00000006378","ENSMUSG00000054555","ENSMUSG00000042460","ENSMUSG00000038633","ENSMUSG00000002957","ENSMUSG00000031328","ENSMUSG00000027547","ENSMUSG00000029455","ENSMUSG00000028936","ENSMUSG00000019564","ENSMUSG00000035268","ENSMUSG00000070044","ENSMUSG00000032902","ENSMUSG00000033161","ENSMUSG00000021477","ENSMUSG00000001119","ENSMUSG00000027611","ENSMUSG00000026917","ENSMUSG00000041324","ENSMUSG00000072235","ENSMUSG00000032548","ENSMUSG00000005973","ENSMUSG00000031432","ENSMUSG00000018865","ENSMUSG00000056758","ENSMUSG00000046133","ENSMUSG00000040808","ENSMUSG00000045519","ENSMUSG00000027803","ENSMUSG00000024937","ENSMUSG00000025993","ENSMUSG00000056481","ENSMUSG00000074783","ENSMUSG00000038843","ENSMUSG00000044279","ENSMUSG00000023443","ENSMUSG00000021953","ENSMUSG00000074269","ENSMUSG00000033436","ENSMUSG00000003161","ENSMUSG00000016528","ENSMUSG00000017774","ENSMUSG00000031622","ENSMUSG00000017493","ENSMUSG00000023932","ENSMUSG00000032011","ENSMUSG00000026630","ENSMUSG00000020644","ENSMUSG00000019920","ENSMUSG00000038418","ENSMUSG00000032902","ENSMUSG00000045545","ENSMUSG00000090084","ENSMUSG00000091490","ENSMUSG00000026879","ENSMUSG00000064263","ENSMUSG00000035778","ENSMUSG00000028024","ENSMUSG00000096768","ENSMUSG00000050732","ENSMUSG00000054484","ENSMUSG00000073497","ENSMUSG00000052040","ENSMUSG00000061517","ENSMUSG00000021994","ENSMUSG00000018906","ENSMUSG00000092035","ENSMUSG00000026879","ENSMUSG00000018604","ENSMUSG00000021427","ENSMUSG00000000957","ENSMUSG00000038296","ENSMUSG00000046727","ENSMUSG00000044641","ENSMUSG00000029177","ENSMUSG00000032382","ENSMUSG00000067818","ENSMUSG00000071078","ENSMUSG00000017707","ENSMUSG00000027233","ENSMUSG00000061143","ENSMUSG00000021186","ENSMUSG00000028832","ENSMUSG00000028195","ENSMUSG00000037049","ENSMUSG00000038534","ENSMUSG00000022048","ENSMUSG00000074637","ENSMUSG00000032346","ENSMUSG00000022237","ENSMUSG00000061393","ENSMUSG00000068566","ENSMUSG00000048616","ENSMUSG00000027611","ENSMUSG00000022150","ENSMUSG00000029860","ENSMUSG00000032353","ENSMUSG00000049929","ENSMUSG00000047187","ENSMUSG00000052837","ENSMUSG00000021536","ENSMUSG00000028063","ENSMUSG00000037940","ENSMUSG00000036390","ENSMUSG00000028567","ENSMUSG00000023087","ENSMUSG00000001552","ENSMUSG00000066721","ENSMUSG00000029848","ENSMUSG00000031633","ENSMUSG00000049327","ENSMUSG00000049288","ENSMUSG00000027536","ENSMUSG00000040726","ENSMUSG00000017607","ENSMUSG00000062170","ENSMUSG00000073002","ENSMUSG00000058976","ENSMUSG00000029993","ENSMUSG00000069114","ENSMUSG00000019851","ENSMUSG00000001847","ENSMUSG00000025902","ENSMUSG00000023885","ENSMUSG00000051730","ENSMUSG00000054889","ENSMUSG00000026341","ENSMUSG00000070044","ENSMUSG00000024538","ENSMUSG00000043998","ENSMUSG00000024594","ENSMUSG00000028988","ENSMUSG00000032334","ENSMUSG00000031068","ENSMUSG00000025491","ENSMUSG00000007038","ENSMUSG00000062661","ENSMUSG00000011096","ENSMUSG00000005732","ENSMUSG00000055044","ENSMUSG00000030107","ENSMUSG00000068699","ENSMUSG00000050732","ENSMUSG00000032294","ENSMUSG00000005610","ENSMUSG00000037989","ENSMUSG00000001555","ENSMUSG00000043629","ENSMUSG00000060477","ENSMUSG00000031358","ENSMUSG00000038366","ENSMUSG00000001510","ENSMUSG00000071078","ENSMUSG00000026600","ENSMUSG00000029648","ENSMUSG00000039476","ENSMUSG00000021477","ENSMUSG00000074227","ENSMUSG00000075046","ENSMUSG00000090137","ENSMUSG00000063632","ENSMUSG00000086219","ENSMUSG00000001403","ENSMUSG00000018012","ENSMUSG00000051159","ENSMUSG00000031558","ENSMUSG00000031502","ENSMUSG00000038534","ENSMUSG00000096175","ENSMUSG00000029162","ENSMUSG00000035778","ENSMUSG00000003131","ENSMUSG00000020080","ENSMUSG00000022841","ENSMUSG00000068245","ENSMUSG00000038415","ENSMUSG00000079111","ENSMUSG00000015312","ENSMUSG00000045503","ENSMUSG00000067038","ENSMUSG00000032366","ENSMUSG00000020766","ENSMUSG00000031353","ENSMUSG00000032348","ENSMUSG00000035203","ENSMUSG00000022841","ENSMUSG00000035268","ENSMUSG00000024014","ENSMUSG00000036275","ENSMUSG00000014599","ENSMUSG00000068101","ENSMUSG00000064010","ENSMUSG00000039209","ENSMUSG00000048644","ENSMUSG00000019539","ENSMUSG00000045667","ENSMUSG00000061186","ENSMUSG00000074218","ENSMUSG00000018819","ENSMUSG00000020080","ENSMUSG00000019997","ENSMUSG00000000378","ENSMUSG00000019188","ENSMUSG00000040405","ENSMUSG00000007655","ENSMUSG00000022749","ENSMUSG00000049422","ENSMUSG00000031875","ENSMUSG00000015053","ENSMUSG00000018293","ENSMUSG00000020023","ENSMUSG00000072825","ENSMUSG00000029452","ENSMUSG00000026553","ENSMUSG00000050335","ENSMUSG00000029761","ENSMUSG00000020766","ENSMUSG00000086503","ENSMUSG00000006488","ENSMUSG00000030682","ENSMUSG00000044641","ENSMUSG00000024661","ENSMUSG00000021876","ENSMUSG00000024190","ENSMUSG00000061517","ENSMUSG00000040731","ENSMUSG00000045954","ENSMUSG00000054850","ENSMUSG00000079029","ENSMUSG00000037337","ENSMUSG00000026657","ENSMUSG00000021102","ENSMUSG00000038539","ENSMUSG00000035692","ENSMUSG00000030688","ENSMUSG00000059430","ENSMUSG00000040731","ENSMUSG00000033585","ENSMUSG00000046818","ENSMUSG00000020023","ENSMUSG00000017861","ENSMUSG00000025647","ENSMUSG00000028465","ENSMUSG00000021508","ENSMUSG00000003541","ENSMUSG00000020388","ENSMUSG00000064264","ENSMUSG00000071451","ENSMUSG00000051811","ENSMUSG00000024621","ENSMUSG00000028832","ENSMUSG00000042215","ENSMUSG00000022265","ENSMUSG00000028478","ENSMUSG00000024985","ENSMUSG00000058558","ENSMUSG00000018819","ENSMUSG00000037242","ENSMUSG00000029452","ENSMUSG00000038418","ENSMUSG00000035027","ENSMUSG00000017615","ENSMUSG00000029810","ENSMUSG00000051579","ENSMUSG00000023764","ENSMUSG00000055148","ENSMUSG00000038803","ENSMUSG00000027533","ENSMUSG00000026249","ENSMUSG00000027523","ENSMUSG00000024063","ENSMUSG00000028536","ENSMUSG00000032346","ENSMUSG00000070619","ENSMUSG00000031217","ENSMUSG00000075702","ENSMUSG00000097581","ENSMUSG00000022108","ENSMUSG00000005103","ENSMUSG00000058976","ENSMUSG00000028478","ENSMUSG00000000296","ENSMUSG00000022587","ENSMUSG00000029229","ENSMUSG00000000555","ENSMUSG00000067764","ENSMUSG00000067367","ENSMUSG00000027233","ENSMUSG00000066688","ENSMUSG00000027014","ENSMUSG00000020733","ENSMUSG00000078924","ENSMUSG00000085114","ENSMUSG00000004317","ENSMUSG00000060639","ENSMUSG00000024750","ENSMUSG00000049866","ENSMUSG00000043681","ENSMUSG00000021268","ENSMUSG00000003534","ENSMUSG00000064010","ENSMUSG00000020173","ENSMUSG00000030272","ENSMUSG00000035199","ENSMUSG00000029162","ENSMUSG00000094796","ENSMUSG00000040413","ENSMUSG00000038415","ENSMUSG00000034312","ENSMUSG00000026450","ENSMUSG00000031438","ENSMUSG00000000001","ENSMUSG00000030672","ENSMUSG00000005609","ENSMUSG00000044641","ENSMUSG00000044709","ENSMUSG00000018845","ENSMUSG00000009585","ENSMUSG00000022174","ENSMUSG00000037060","ENSMUSG00000001911","ENSMUSG00000061787","ENSMUSG00000046818","ENSMUSG00000041757","ENSMUSG00000048376","ENSMUSG00000040856","ENSMUSG00000078566","ENSMUSG00000027004","ENSMUSG00000000594","ENSMUSG00000050148","ENSMUSG00000032291","ENSMUSG00000066688","ENSMUSG00000037060","ENSMUSG00000095071","ENSMUSG00000015932","ENSMUSG00000026509","ENSMUSG00000040564","ENSMUSG00000032495","ENSMUSG00000039646","ENSMUSG00000032399","ENSMUSG00000018965","ENSMUSG00000028645","ENSMUSG00000096619","ENSMUSG00000070890","ENSMUSG00000041881","ENSMUSG00000015312","ENSMUSG00000067818","ENSMUSG00000029752","ENSMUSG00000042745","ENSMUSG00000035274","ENSMUSG00000023443","ENSMUSG00000049521","ENSMUSG00000023904","ENSMUSG00000030782","ENSMUSG00000028772","ENSMUSG00000020059","ENSMUSG00000041012","ENSMUSG00000054312","ENSMUSG00000047146","ENSMUSG00000023348","ENSMUSG00000076437","ENSMUSG00000024012","ENSMUSG00000052854","ENSMUSG00000045519","ENSMUSG00000024308","ENSMUSG00000034957","ENSMUSG00000038676","ENSMUSG00000028234","ENSMUSG00000022836","ENSMUSG00000036371","ENSMUSG00000020077","ENSMUSG00000006356","ENSMUSG00000025665","ENSMUSG00000020577","ENSMUSG00000054272","ENSMUSG00000020099","ENSMUSG00000021039","ENSMUSG00000040483","ENSMUSG00000054727","ENSMUSG00000087283","ENSMUSG00000035946","ENSMUSG00000037062","ENSMUSG00000024621","ENSMUSG00000031231","ENSMUSG00000041722","ENSMUSG00000038872","ENSMUSG00000061877","ENSMUSG00000018339","ENSMUSG00000021404","ENSMUSG00000041488","ENSMUSG00000020432","ENSMUSG00000074218","ENSMUSG00000007038","ENSMUSG00000041881","ENSMUSG00000030220","ENSMUSG00000024805","ENSMUSG00000028121","ENSMUSG00000023932","ENSMUSG00000015759","ENSMUSG00000002059","ENSMUSG00000047414","ENSMUSG00000019564","ENSMUSG00000027359","ENSMUSG00000056492","ENSMUSG00000029484","ENSMUSG00000063632","ENSMUSG00000072244","ENSMUSG00000038803","ENSMUSG00000001105","ENSMUSG00000006931","ENSMUSG00000022174","ENSMUSG00000027955","ENSMUSG00000079479","ENSMUSG00000031575","ENSMUSG00000050212","ENSMUSG00000029522","ENSMUSG00000030413","ENSMUSG00000017615","ENSMUSG00000074476","ENSMUSG00000022899","ENSMUSG00000070031","ENSMUSG00000003051","ENSMUSG00000027750","ENSMUSG00000006373","ENSMUSG00000030268","ENSMUSG00000075046","ENSMUSG00000015289","ENSMUSG00000006818","ENSMUSG00000050122","ENSMUSG00000026576","ENSMUSG00000007041","ENSMUSG00000032353","ENSMUSG00000024664","ENSMUSG00000029380","ENSMUSG00000022900","ENSMUSG00000035314","ENSMUSG00000022892","ENSMUSG00000023905","ENSMUSG00000003382","ENSMUSG00000022037","ENSMUSG00000046711","ENSMUSG00000043336","ENSMUSG00000087106","ENSMUSG00000026281","ENSMUSG00000028597","ENSMUSG00000024953","ENSMUSG00000026674","ENSMUSG00000054364","ENSMUSG00000027082","ENSMUSG00000056888","ENSMUSG00000037736","ENSMUSG00000027077","ENSMUSG00000040699","ENSMUSG00000026879","ENSMUSG00000040713","ENSMUSG00000026380","ENSMUSG00000061877","ENSMUSG00000022836","ENSMUSG00000027134","ENSMUSG00000056214","ENSMUSG00000070605","ENSMUSG00000015714","ENSMUSG00000000805","ENSMUSG00000034707","ENSMUSG00000037989","ENSMUSG00000010067","ENSMUSG00000015312","ENSMUSG00000068220","ENSMUSG00000052854","ENSMUSG00000034659","ENSMUSG00000060591","ENSMUSG00000032902","ENSMUSG00000024772","ENSMUSG00000027602","ENSMUSG00000028961","ENSMUSG00000000031","ENSMUSG00000086445","ENSMUSG00000025255","ENSMUSG00000050122","ENSMUSG00000046841","ENSMUSG00000021835","ENSMUSG00000002265","ENSMUSG00000019997","ENSMUSG00000027082","ENSMUSG00000091490","ENSMUSG00000032060","ENSMUSG00000023495","ENSMUSG00000000296","ENSMUSG00000086445","ENSMUSG00000038296","ENSMUSG00000041718","ENSMUSG00000036275","ENSMUSG00000031651","ENSMUSG00000023939","ENSMUSG00000074269","ENSMUSG00000001119","ENSMUSG00000096188","ENSMUSG00000058569","ENSMUSG00000028965","ENSMUSG00000021687","ENSMUSG00000048126")

AGG <- setOrderingFilter(AGG, orderingGenes)
png(file = paste0('t-SNE','_ordering','.png'), width = 7, height = 7, units = 'in', res = 300)
plot_ordering_genes(AGG)
dev.off()
png(file = paste0('t-SNE','_variance','.png'), width = 7, height = 7, units = 'in', res = 300)
plot_pc_variance_explained(AGG, return_all = T)
dev.off()

AGG <- reduceDimension(AGG, max_components = 2, norm_method = 'log', reduction_method = 'tSNE', num_dim = 10, verbose = T)
AGG <- clusterCells(AGG, verbose = T)
png(file = paste0('t-SNE','_cell_clusters_Batch','.png'), width = 7, height = 7, units = 'in', res = 300)
plot_cell_clusters(AGG, color_by = 'as.factor(Batch)', cell_size = 0.3) + scale_color_manual(labels = Batch_labels, values = Batch_cols, name = 'Batch')
dev.off()

png(file = paste0('t-SNE','_cell_clusters_Batch_facet','.png'), width = 7, height = 7, units = 'in', res = 300)
plot_cell_clusters(AGG, color_by = 'as.factor(Batch)', cell_size = 0.3) + facet_wrap(~Batch) + scale_color_manual(labels = Batch_labels, values = Batch_cols, name = 'Batch')
dev.off()
save(AGG, file = 't-SNE.Robj')

sessionInfo()
